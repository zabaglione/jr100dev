# フェーズ1 (DSL + アセンブラ MVP) スコープ確認

## 目標
- DSL ソースから `.bin` と `.prg` を生成できる最小機能アセンブラを提供する。
- `jr100dev` CLI に `assemble` サブコマンドを実装し、単一ソースのビルドを可能にする。
- 命令バリデーションは生成予定の `asm/opcodes_mb8861h.py` を前提とし、暫定テーブルで MVP を成立させる。

## 必須機能
1. 字句・構文解析
   - コメント `;`、識別子、10/16/2 進整数、単一文字、二重引用符文字列に対応。
2. 2 パス処理
   - 第 1 パスでラベル値と `.equ` を解決し、分岐距離を確認。
   - 第 2 パスで機械語を生成し、マップ／リストファイルを出力できる設計とする。
3. 疑似命令
   - `.org`, `.byte`, `.word`, `.ascii`, `.equ`, `.fill`, `.align` を最小でサポート。
   - メモリアクセス命令は DIR（ページ 0）と EXT を自動判別し、`<expr` / `>expr` で強制指定できる。
4. 出力
   - 生バイナリ (`.bin`)、`.prg` パッケージ、および JSON ベース中間オブジェクト（再配置情報付き）を生成できるようにする。

## 依存関係
- 命令テーブル：`asm/opcodes_mb8861h.py`（自動生成前はダミーを同梱）。
- `.prg` 仕様：フェーズ0 の梱包メモを参照しつつ、実装時にエミュレータ実装を確認する。

## リスク
- 命令テーブルの未整備によりテスト範囲が限定される可能性。
- `.prg` 仕様の未確定部分が MVP の互換性を阻害する可能性。

## 次ステップ
- `asm/lexer.py`, `asm/parser.py`, `asm/encoder.py` の骨格を先に追加し、CLI から参照できるようにする。
- `jr100dev/cli/main.py` に `argparse` ベースの CLI を実装し、雛形コマンドを動作させる。
