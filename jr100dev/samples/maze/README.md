# maze サンプル

## 概要
- 起動時にタイトル画面が表示され、`EASY` (11×11) / `NORMAL` (21×21) / `HARD` (41×41) の 3 レベルから選択できます。
- `I` / `M` キーでカーソルを上下に移動、`Z` キーで選択したレベルを開始します。選択中の行は 0.5 秒間隔で通常／反転表示が切り替わります。
- ゲーム中は `I` (上) / `J` (左) / `K` (右) / `M` (下) で移動、`R` で同レベルを再スタートできます。ゴール (右下) に到達するとステップカウンタが停止し、`R` を押すまで継続します。
- `HARD` レベルでは 41×41 の迷路を 32×23 のビューポートでスクロール表示します。その他のレベルは全体が表示されるためスクロールしません。
- 迷路生成は壁伸ばし法ベースのアルゴリズムで毎回異なるレイアウトを作成します。ワーク領域やレベル設定は `maze_data.asm` にまとまっています。

## ビルド
```sh
make -C samples/maze
```
- `Makefile` が `maze_data.asm` と `maze_gen.asm`、およびメインエントリを組み合わせて `build/maze.prg` を生成します。
- 付属のテスト (`make -C samples/maze test`) を実行すると、`jr100emu.debug_runner` を利用したメモリダンプ確認が行えます。

## 実行
1. `samples/maze/build/maze.prg` を JR-100 エミュレーターにロードし、`A=USR($300)` を実行します。
2. タイトル画面で `I` / `M` でレベルを選択し、`Z` キーで開始します。
3. ゲーム中は `I` / `J` / `K` / `M` で移動します。`HARD` レベルではプレイヤーが端に近づくと自動的にスクロールします。
4. ゴールへ到達すると最下段の "MOV" カウンタが停止し、`R` キーで同じレベルを再開できます。

## メモ
- `maze/tests/` にはスタック操作・通路掘削などを検証する PRG が揃っており、`make -C samples/maze test` で自動チェックできます。
- VRAM の空白は JR-100 の文字コード `$40` に合わせて変換しています。直接 VRAM に書き込む場合は ASCII 空白 (`$20`) のままでは表示されない点に注意してください。
- 大きな迷路用にワーク領域を最大サイズ (41×41) で確保しているため、レベルを追加する際はメモリ残量も考慮してください。
